<!DOCTYPE html>
<html>
    
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>WebGL Test</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
		<script type="text/javascript" src="lib/gl-matrix.js"></script>
		<script type="text/javascript" src="lib/webgl-utils.js"></script>
		<script type="text/javascript" src="lib/stats.min.js"></script>
		
		<script type="text/javascript" src="initialization.js"></script>
        <script type="text/javascript" src="index.js"></script>

		<script id="shader-vs" type="x-shader/x-vertex">
			attribute vec3 aVertexPosition;
			attribute vec2 aTextureCoord;

			uniform mat4 uMVMatrix;
			uniform mat4 uPMatrix;

			varying vec2 vTextureCoord;


			void main(void) {
				gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
				vTextureCoord = aTextureCoord;
			}
		</script>

		<script id="shader-fs" type="x-shader/x-fragment">
			precision mediump float;

			varying vec2 vTextureCoord;

			uniform sampler2D uSampler;

			void main(void) {
				float stepX = 1.0/640.0;
				float stepY = 1.0/480.0;
				float left = texture2D(uSampler, vTextureCoord+vec2(-stepX, 0.0)).r;
				float right = texture2D(uSampler, vTextureCoord+vec2(stepX, 0.0)).r;
				float bottom = texture2D(uSampler, vTextureCoord+vec2(0.0, -stepY)).r;
				float top = texture2D(uSampler, vTextureCoord+vec2(0.0, stepY)).r;
				vec3 v1 = vec3(0.0, 1.0, top-bottom);
				vec3 v2 = vec3(1.0, 0.0, right-left);
				vec3 v3 = cross(v1, v2);
				
				vec4 a = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
				gl_FragColor = vec4(a.xxx, 1.0);
				//gl_FragColor = vec4(v3, 1.0);
			}
		</script>
    </head>
    
    <body>
		<canvas id="main-canvas" width="640" height="480" style="position:absolute; left:0;top:0;"></canvas>
		<table style="position:absolute; left:640px;top:0;">
			<tr>
				<td>Render</td>
				<td>Web Socket</td>
			</tr>
			<tr>
				<td id="stats-render"></td>
				<td id="stats-socket"></td>
			</tr>
			<tr>
				<td>Web Socket</td>
				<td></td>
			</tr>
		</table>
    </body>

</html>